# 第3章
## チェックシート
1. 「ほぼ静的なページ」の「静的」とはどのようなものでしょうか？
    - あらかじめ用意されていて、変わらないということ
    - 静的なウェブページは、サーバー上にあらかじめ作成され、保存されたHTMLファイルで、それがそのままの形でユーザーのウェブブラウザに送信されます。このタイプのページは、ユーザーがアクセスするたびに同じ内容が表示され、コンテンツは手動で更新する必要があります。

2. HTTPメソッドにはどのような種類がありますか？
    - GET
    - POST
    - PUT
    - DELETE

3. HTTPメソッドのうち、GETとPOSTはどのような時に使われるものでしょうか？
    - GET
        - 主にデータの取得するとき
    - POST
        - 何か（アカウントなど）を作成するとき

3. 自動テストを作成するメリットにはどのようなものがあるでしょうか？
以下の単語を用いて説明してください。
・バグ
・リファクタリング
・設計
    - 自動テストの導入は、バグの早期発見を促し、リファクタリングを効率的に行うための信頼性の高い安全網を提供し、より堅牢な設計を推進することで、ソフトウェアの品質とメンテナンス性を向上させます

## 演習
1. GithubがMarkdown記法のREADME (リスト 3.3) をHTMLとして正しく描画しているか、確認してみてください。
    - ![](images/2023-10-18-20-42-26.png)

2. 本番環境 (Heroku) のルートURLにアクセスして、デプロイが成功したかどうか確かめてみてください。
    - Heroku使っていないので未対応

3. Fooというコントローラを生成し、その中にbarとbazアクションを追加してみてください。
    - ![](images/2023-10-18-21-35-48.png)

4. コラム 3.1で紹介したテクニックを駆使して、Fooコントローラとそれに関連するアクションを削除してみてください。
    - ![](images/2023-10-18-21-38-41.png)

5. サンプルアプリケーションにContact (問い合わせ先) ページを作成してください16 (ヒント: まずはリスト 3.15を参考にして、/static_pages/contactというURLのページに「Contact | Ruby on Rails Tutorial Sample App」というタイトルが存在するかどうかを確認するテストを最初に作成しましょう。次に、3.3.3でAboutページを作ったときのと同じように、Contactページにもリスト 3.40のコンテンツを表示してみましょう。)。
    - ![](images/2023-10-19-09-53-26.png)

6. リスト 3.41にrootルーティングを追加したことで、root_urlというRailsヘルパーが使えるようになりました (以前、static_pages_home_urlが使えるようになったときと同じです)。リスト 3.42の（コードを書き込む）と記された部分を置き換えて、rootルーティングのテストを書いてみてください。
    - ```
        test "should get root" do
            get  root_url
            assert_response :success
        end
        ```

7. 実はリスト 3.41のコードを書いていたので、先ほどの課題のテストは既に green になっているはずです。このような場合、テストを変更する前から成功していたのか、変更した後に成功するようになったのか、判断が難しいです。リスト 3.41のコードがテスト結果に影響を与えていることを確認するため、リスト 3.43のようにrootルーティングをコメントアウトして見て、 red になるかどうか確かめてみましょう (なおRubyのコメント機能については4.2.1で説明します)。最後に、コメントアウトした箇所を元に戻し (すなわちリスト 3.41に戻し)、テストが green になることを確認してみましょう。
    - コメントアウト時
        - `4 runs, 3 assertions, 0 failures, 1 errors, 0 skips`
    - コメントアウト解除
        - `4 runs, 4 assertions, 0 failures, 0 errors, 0 skips`

# 第4章

## チェックシート
1. 配列とハッシュの違いはなんでしょうか？
以下の単語を用いて説明してください。
・インデックス
・並び順
    - 配列はインデックスによって要素の並び順が決まっているのに対して、ハッシュはキーと値のペアなので並び順はない

2. 文字列でのシングルクォートとダブルクォートの違いはなんでしょうか？
以下の単語を用いて説明してください。
・文字列
・特殊文字
    - 文字列において、シングルクォートは特殊文字をエスケープせず、そのままの文字列を返すのに対し、ダブルクォートは特殊文字を解釈する

3. クラスとインスタンスは、それぞれどのようなものでしょうか？
「メソッド」という単語を用いて説明してください。
    - クラスはメソッドなどを定義した設計図で、インスタンスはそのクラスに基づいて生成されたオブジェクト

4. カスタムヘルパーとは、どのような目的で作っているものでしょうか？
    - 繰り返し使われるロジックなどをモジュール化して、コードの保守性を高めたり、可読性を向上させる

## 演習
1. city変数に適当な市区町村を、prefecture変数に適当な都道府県を代入してください。
2. 先ほど作った変数と式展開を使って、「東京都 新宿区」のような住所の文字列を作ってみましょう。出力にはputsを使ってください。
3. 上記の文字列の間にある半角スペースをタブに置き換えてみてください。(ヒント: 改行文字と同じで、タブも特殊文字です)
4. タブに置き換えた文字列を、ダブルクォートからシングルクォートに置き換えてみるとどうなるでしょうか?
    - ![](images/2023-10-19-11-39-59.png)

5. "racecar" の文字列の長さはいくつですか? lengthメソッドを使って調べてみてください。
 
6. reverseメソッドを使って、"racecar"の文字列を逆から読むとどうなるか調べてみてください。

7. 変数sに "racecar" を代入してください。その後、比較演算子 (==) を使って変数sとs.reverseの値が同じであるかどうか、調べてみてください。

8. リスト 4.9を実行すると、どんな結果になるでしょうか? 変数sに "onomatopoeia" という文字列を代入するとどうなるでしょうか? ヒント: 上矢印 (またはCtrl-Pコマンド) を使って以前に使ったコマンドを再利用すると一からコマンドを全部打ち込む必要がなくて便利ですよ。 
- ![](images/2023-10-19-11-55-32.png)

9. リスト 4.10の（コードを書き込む）の部分を適切なコードに置き換え、回文かどうかをチェックするメソッドを定義してみてください。ヒント: リスト 4.9の比較方法を参考にしてください。
    - ```
        def palindrome_tester(s)
            if s == s.reverse
                puts "It's a palindrome!"
            else
                puts "It's not a palindrome."
            end
        end
      ```

9. 上で定義したメソッドを使って “racecar” と “onomatopoeia” が回文かどうかを確かめてみてください。１つ目は回文である、２つ目は回文でない、という結果になれば成功です。
    - ![](images/2023-10-19-14-30-30.png)

10. palindrome_tester("racecar")に対してnil?メソッドを呼び出し、戻り値がnilであるかどうかを確認してみてください (つまりnil?を呼び出した結果がtrueであることを確認してください)。このメソッドチェーンは、nil?メソッドがリスト 4.10の戻り値を受け取り、その結果を返しているという意味になります。
    - ![](images/2023-10-19-14-36-00.png)

11. 文字列「A man, a plan, a canal, Panama」を ", " で分割して配列にし、変数aに代入してみてください。

12. 今度は、変数aの要素を連結した結果 (文字列) を、変数sに代入してみてください。

13. 変数sを半角スペースで分割した後、もう一度連結して文字列にしてください (ヒント: メソッドチェーンを使うと１行でもできます)。リスト 4.10で使った回文をチェックするメソッドを使って、(現状ではまだ) 変数sが回文ではないことを確認してください。downcaseメソッドを使って、s.downcaseは回文であることを確認してください。

14. aからzまでの範囲オブジェクトを作成し、7番目の要素を取り出してみてください。同様にして、後ろから７番目の要素を取り出してみてください。(ヒント: 範囲オブジェクトを配列に変換するのを忘れないでください)
    - ![](images/2023-10-19-14-55-19.png)

15. 範囲オブジェクト0..16を使って、各要素の２乗を出力してください。
16. yeller (大声で叫ぶ) というメソッドを定義してください。このメソッドは、文字列の要素で構成された配列を受け取り、各要素を連結した後、大文字にして結果を返します。例えばyeller(['o', 'l', 'd'])と実行したとき、"OLD"という結果が返ってくれば成功です。ヒント: mapとupcaseとjoinメソッドを使ってみましょう。
17. random_subdomainというメソッドを定義してください。このメソッドはランダムな8文字を生成し、文字列として返します。ヒント: サブドメインを作るときに使ったRubyコードをメソッド化したものです。
18. リスト 4.12の「?」の部分を、それぞれ適切なメソッドに置き換えてみてください。ヒント:split、shuffle、joinメソッドを組み合わせると、メソッドに渡された文字列 (引数) をシャッフルさせることができます。
    - ![](images/2023-10-19-15-54-46.png)

19. キーが'one'、'two'、'three'となっていて、それぞれの値が'uno'、'dos'、'tres'となっているハッシュを作ってみてください。その後、ハッシュの各要素をみて、それぞれのキーと値を"'#{key}'はスペイン語で'#{value}'"といった形で出力してみてください。

20. person1、person2、person3という３つのハッシュを作成し、それぞれのハッシュに:firstと:lastキーを追加し、適当な値 (名前など) を入力してください。その後、次のようなparamsというハッシュのハッシュを作ってみてください。1.) キーparams[:father]の値にperson1を代入、2). キーparams[:mother]の値にperson2を代入、3). キーparams[:child]の値にperson3を代入。最後に、ハッシュのハッシュを調べていき、正しい値になっているか確かめてみてください。(例えばparams[:father][:first]がperson1[:first]と一致しているか確かめてみてください)
    - ![](images/2023-10-20-10-01-39.png)

21. userというハッシュを定義してみてください。このハッシュは３つのキー:name、:email、:password_digestを持っていて、それぞれの値にあなたの名前、あなたのメールアドレス、そして16文字からなるランダムな文字列が代入されています。
    - ```
        user = { 
            irb(main):025:1*   name: 'yanase', 
            irb(main):026:1*   email: 'yanase@example.com', 
            irb(main):027:1*   password_digest: SecureRandom.hex(8) # 16文字のランダムな文字列
            irb(main):028:0> }
            => {:name=>"yanase", :email=>"yanase@example.com", :password_digest=>"4cc01ed4105c0516"}
      ```

22. Ruby API (訳注: もしくはるりまサーチ) を使って、Hashクラスのmergeメソッドについて調べてみてください。次のコードを実行せずに、どのような結果が返ってくるか推測できますか? 推測できたら、実際にコードを実行して推測があっていたか確認してみましょう。
    - { "a" => 100, "b" => 300}

23. 1から10の範囲オブジェクトを生成するリテラルコンストラクタは何でしたか? (復習です)
    - (1..10)

24. 今度はRangeクラスとnewメソッドを使って、1から10の範囲オブジェクトを作ってみてください。ヒント: newメソッドに2つの引数を渡す必要があります
    - range = Range.new(1, 10)

25. 比較演算子==を使って、上記２つの課題で作ったそれぞれのオブジェクトが同じであることを確認してみてください。
    - ![](images/2023-10-20-10-15-00.png)

26. Rangeクラスの継承階層を調べてみてください。同様にして、HashとSymbolクラスの継承階層も調べてみてください。
    - ```
        irb(main):036:0> Range.superclass
            => Object
        irb(main):037:0> Object.superclass
            => BasicObject
        irb(main):038:0> BasicObject.superclass
            => nil
        irb(main):039:0> 
      ```

27. リスト 4.15にあるself.reverseのselfを省略し、reverseと書いてもうまく動くことを確認してみてください。
    - ![](images/2023-10-20-10-29-23.png)

28. palindrome?メソッドを使って、“racecar”が回文であり、“onomatopoeia”が回文でないことを確認してみてください。南インドの言葉「Malayalam」は回文でしょうか? ヒント: downcaseメソッドで小文字にすることを忘れないで。

29. リスト 4.16を参考に、Stringクラスにshuffleメソッドを追加してみてください。ヒント: リスト 4.12も参考になります。

30. リスト 4.16のコードにおいて、self.を削除してもうまく動くことを確認してください。
    - ![](images/2023-10-20-10-42-40.png)

31. 第2章で作ったToyアプリケーションのディレクトリでRailsコンソールを開き、User.newと実行することでuserオブジェクトが生成できることを確認してみましょう。
32. 生成したuserオブジェクトのクラスの継承階層を調べてみてください。
    - ![](images/2023-10-20-12-32-38.png)

33. Userクラスで定義されているname属性を修正して、first_name属性とlast_name属性に分割してみましょう。また、それらの属性を使って "Michael Hartl" といった文字列を返すfull_nameメソッドを定義してみてください。最後に、formatted_emailメソッドの@nameの部分を、full_nameに置き換えてみましょう (元々の結果と同じになっていれば成功です)
34. "Hartl, Michael" といったフォーマット (苗字と名前がカンマ+半角スペースで区切られている文字列) で返すalphabetical_nameメソッドを定義してみましょう。
35. full_name.splitとalphabetical_name.split(', ').reverseの結果を比較し、同じ結果になるかどうか確認してみましょう。
    - ![](images/2023-10-20-13-46-21.png)


# 第5章
## チェックシート
1. パーシャルにはどのようなメリットがあるでしょうか？
    - 同じコードを繰り返し書く必要がなくなる
    - 可読性や保守性の向上に繋がる
2. Asset Pipelineにはどのような役割があるでしょうか？
    - 開発環境と本番環境という、2つの異なった状況に対してそれぞれ最高の環境を提供してくれる
    - 最大のメリットの1つは、本番のアプリケーションで効率的になるように最適化されたアセットも自動的に生成されること
    - 
3. SCSSを使用するとどのようなメリットがあるでしょうか？以下の単語を用いて説明してください。
・ネスト
・変数
    - スタイルシート内で変数を利用することができ、ネストによって親子関係を直感的に表現することができる


## 演習
1. Webページと言ったらネコ画像、というぐらいにはWebにはネコ画像が溢れていますよね。リスト 5.4のコマンドを使って、図 5.3のネコ画像をダウンロードしてきましょう8 。
2. mvコマンドを使って、ダウンロードしたkitten.jpgファイルを適切なアセットディレクトリに移動してください (参考: 5.2.1)。
    - ![](images/2023-10-21-16-17-09.png)

3. image_tagを使って、kitten.jpg画像を表示してみてください
    - ![](images/2023-10-21-16-20-47.png)

4. リスト 5.10を参考にして、5.1.1.1で使ったネコ画像をコメントアウトしてみてください。また、ブラウザのHTMLインスペクタ機能を使って、コメントアウトするとHTMLのソースからも消えていることを確認してみてください。
    - ![](images/2023-10-21-16-55-18.png)

5. リスト 5.11のコードをcustom.scssに追加し、すべての画像を非表示にしてみてください。うまくいけば、Railsのロゴ画像がHomeページから消えるはずです。先ほどと同様にインスペクタ機能を使って、今度はHTMLのソースコードは残ったままで、画像だけが表示されなくなっていることを確認してみてください。
    - ![](images/2023-10-21-16-56-32.png)

6. Railsがデフォルトで生成するheadタグの部分を、リスト 5.18のようにrenderに置き換えてみてください。ヒント: 単純に削除してしまうと後でパーシャルを１から書き直す必要が出てくるので、削除する前にどこかに退避しておきましょう。

7. リスト 5.18のようなパーシャルはまだ作っていないので、現時点ではテストは redになっているはずです。実際にテストを実行して確認してみましょう。
    - ![](images/2023-10-21-17-11-46.png)
 
8. layoutsディレクトリにheadタグ用のパーシャルを作成し、先ほど退避しておいたコードを書き込み、最後にテストが green に戻ることを確認しましょう。
    - ![](images/2023-10-21-17-13-39.png)

9. 5.2.2で提案したように、footerのCSSを手作業で変換してみましょう。具体的には、リスト 5.17の内容を１つずつ変換していき、リスト 5.20のようにしてみてください。
    -  ```
        footer {
            margin-top: 45px;
            padding-top: 5px;
            border-top: 1px solid $gray-medium-light;
            color: $gray-light;
            a {
                color: $gray;
                &:hover {
                color: $gray-darker;
                }
            }
            small {
                float: left;
            }
            ul {
                float: right;
                list-style: none;
                li {
                float: left;
                margin-left: 15px;
                }
            }
        }
     ```

10. 実は名前付きルートは、as:オプションを使って変更することができます。有名なFar Sideの漫画に倣って、Helpページの名前付きルートをhelfに変更してみてください (リスト 5.29)。
    - ```
        Rails.application.routes.draw do
            root 'static_pages#home'
            get  '/help',    to: 'static_pages#help', as: :helf
            get  '/about',   to: 'static_pages#about'
            get  '/contact', to: 'static_pages#contact'
        end
      ```

11. 先ほどの変更により、テストが redになっていることを確認してください。リスト 5.28を参考にルーティングを更新して、テストを greenにして見てください。
    - ```
        // static_pages_controller_test.rb

        test "should get help" do
            get helf_path
            assert_response :success
            assert_select "title", "Help | Ruby on Rails Tutorial Sample App"
        end
      ```

12. エディタのUndo機能を使って、今回の演習で行った変更を元に戻して見てください。
    - ![](images/2023-10-21-22-46-26.png)

13. リスト 5.29のようにhelfルーティングを作成し、レイアウトのリンクを更新してみてください。
    - [変更コミット](https://github.com/yanase-kenta0505/rails_tutorial_sample_app/commit/ab0e7755d2374bcfec211ec4475ea8edc1c2178a)

14. 前回の演習と同様に、エディタのUndo機能を使ってこの演習で行った変更を元に戻してみてください。
    - [変更を戻すコミット](https://github.com/yanase-kenta0505/rails_tutorial_sample_app/commit/2f16e6efdcba1272d39b969b558936f3b9985473)

15. footerパーシャルのabout_pathをcontact_pathに変更してみて、テストが正しくエラーを捕まえてくれるかどうか確認してみてください。
    - ![](images/2023-10-21-23-35-21.png)

16. リスト 5.35で示すように、Applicationヘルパーで使っているfull_titleヘルパーを、test環境でも使えるようにすると便利です。こうしておくと、リスト 5.36のようなコードを使って、正しいタイトルをテストすることができます。ただし、これは完璧なテストではありません。例えばベースタイトルに「Ruby on Rails Tutoial」といった誤字があったとしても、このテストでは発見することができないでしょう。この問題を解決するためには、full_titleヘルパーに対するテストを書く必要があります。そこで、Applicationヘルパーをテストするファイルを作成し、リスト 5.37の（コードを書き込む）の部分を適切なコードに置き換えてみてください。ヒント: リスト 5.37ではassert_equal <期待される値>, <実際の値>といった形で使っていましたが、内部では==演算子で期待される値と実際の値を比較し、正しいかどうかのテストをしています。
    - [演習対応](https://github.com/yanase-kenta0505/rails_tutorial_sample_app/commit/29cfaea06ac2ff9affa056961378c38a5538ebc3)

17. 表 5.1を参考にしながらリスト 5.41を変更し、users_new_urlではなくsignup_pathを使えるようにしてみてください。
    - ```
        // users_controller_test.rb

        class UsersControllerTest < ActionDispatch::IntegrationTest
            test "should get new" do
                get signup_path
                assert_response :success
            end
        end
      ```

18. 先ほどの変更を加えたことにより、テストが redになったことを確認してください。なお、この演習はテスト駆動開発 (コラム 3.3) で説明した red/green のリズムを作ることを目的としています。このテストは次の5.4.2で greenになるよう修正します。
    - ![](images/2023-10-22-11-33-43.png)

19. もしまだ5.4.1.1の演習に取り掛かっていなければ、まずはリスト 5.41のように変更し、名前付きルートsignup_pathを使えるようにしてください。また、リスト 5.43で名前付きルートが使えるようになったので、現時点でテストが greenになっていることを確認してください。
    - ![](images/2023-10-22-17-07-50.png)

20. 先ほどのテストが正しく動いていることを確認するため、signupルートの部分をコメントアウトし、テスト redになることを確認してください。確認できたら、コメントアウトを解除して greenの状態に戻してください。
    - ![](images/2023-10-22-17-37-42.png)

21. リスト 5.32の統合テストにsignupページにアクセスするコードを追加してください (getメソッドを使います)。コードを追加したら実際にテストを実行し、結果が正しいことを確認してください。ヒント: リスト 5.36で紹介したfull_titleヘルパーを使ってみてください。
    - ![](images/2023-10-22-18-00-20.png)

# 第6章
## チェックシ-ト
## 演習
1. Railsはdb/ディレクトリの中にあるschema.rbというファイルを使っています。これはデータベースの構造 (スキーマ (schema) と呼びます) を追跡するために使われます。さて、あなたの環境にあるdb/schema.rbの内容を調べ、その内容とマイグレーションファイル (リスト 6.2) の内容を比べてみてください。
    - ![](images/2023-10-23-11-27-44.png)

2. ほぼすべてのマイグレーションは、元に戻すことが可能です (少なくとも本チュートリアルにおいてはすべてのマイグレーションを元に戻すことができます)。元に戻すことを「ロールバック (rollback)と呼び、Railsではdb:rollbackというコマンドで実現できます。
  $ rails db:rollback
上のコマンドを実行後、db/schema.rbの内容を調べてみて、ロールバックが成功したかどうか確認してみてください (コラム 3.1ではマイグレーションに関する他のテクニックもまとめているので、参考にしてみてください)。上のコマンドでは、データベースからusersテーブルを削除するためにdrop_tableコマンドを内部で呼び出しています。これがうまくいくのは、drop_tableとcreate_tableがそれぞれ対応していることをchangeメソッドが知っているからです。この対応関係を知っているため、ロールバック用の逆方向のマイグレーションを簡単に実現することができるのです。なお、あるカラムを削除するような不可逆なマイグレーションの場合は、changeメソッドの代わりに、upとdownのメソッドを別々に定義する必要があります。詳細については、Railsガイドの「Active Record マイグレーション」を参照してください。
    - ![](images/2023-10-23-11-35-06.png)

3. もう一度rails db:migrateコマンドを実行し、db/schema.rbの内容が元に戻ったことを確認してください。
    - ![](images/2023-10-23-11-38-10.png)